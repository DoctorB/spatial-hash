using System.Collections.Generic;
using System.Linq;

namespace spatial_hash
{
  public class FrameCounter
  {
    public const int MAXIMUM_SAMPLES = 100;

    private readonly Queue<float> _sampleBuffer = new Queue<float>();
    public long TotalFrames { get; private set; }
    public float TotalSeconds { get; private set; }
    public float AverageFramesPerSecond { get; private set; }
    public float CurrentFramesPerSecond { get; private set; }

    public bool Update(float deltaTime)
    {
      CurrentFramesPerSecond = 1.0f/deltaTime;

      _sampleBuffer.Enqueue(CurrentFramesPerSecond);

      if (_sampleBuffer.Count > MAXIMUM_SAMPLES)
      {
        _sampleBuffer.Dequeue();
        AverageFramesPerSecond = _sampleBuffer.Average(i => i);
      }
      else
      {
        AverageFramesPerSecond = CurrentFramesPerSecond;
      }

      TotalFrames++;
      TotalSeconds += deltaTime;
      return true;
    }
  }
}